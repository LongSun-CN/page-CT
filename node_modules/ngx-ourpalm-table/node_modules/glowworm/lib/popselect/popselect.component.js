import { Component, EventEmitter, forwardRef, Input, Output, ViewChild, ViewEncapsulation } from "@angular/core";
import { GwOverlayDirective } from "../core/overlay.directive";
import { NG_VALUE_ACCESSOR } from "@angular/forms";
export var GW_POPSELECT_COMPONENT_VALUE_ACCESSOR = {
    provide: NG_VALUE_ACCESSOR,
    useExisting: forwardRef(function () { return GwPopSelectComponent; }),
    multi: true
};
var GwPopSelectComponent = (function () {
    function GwPopSelectComponent() {
        this.filterKeys = ['text'];
        this.placement = 'bottom-left';
        this.onConfirm = new EventEmitter();
        this.onCancel = new EventEmitter();
    }
    Object.defineProperty(GwPopSelectComponent.prototype, "data", {
        get: function () {
            return this._data;
        },
        set: function (data) {
            this._data = data;
            this._refreshUI();
        },
        enumerable: true,
        configurable: true
    });
    GwPopSelectComponent.prototype.onSelect = function (_item) {
        this._data.forEach(function (item) {
            if (item !== _item) {
                item.__checked__ = false;
            }
        });
    };
    GwPopSelectComponent.prototype.onConfirmEvent = function (event) {
        this.overlay.hide();
        var values = this._data.filter(function (item) { return item.__checked__; });
        if (values.length == 1) {
            var val = values[0].id;
            this._val = val;
        }
        else {
            this._val = null;
        }
        this._filterVal = '';
        this._touchFun(this._val);
        this._changeFun(this._val);
        this.onConfirm.emit(event);
    };
    GwPopSelectComponent.prototype.onCancelEvent = function (event) {
        this._filterVal = '';
        this.overlay.hide();
        this.onCancel.emit(event);
        this.writeValue(this._val);
    };
    GwPopSelectComponent.prototype.onOverlayHideEvent = function () {
        this._filterVal = '';
    };
    GwPopSelectComponent.prototype.writeValue = function (obj) {
        this._val = obj;
        this._refreshUI();
    };
    GwPopSelectComponent.prototype.registerOnChange = function (fn) {
        this._changeFun = fn;
    };
    GwPopSelectComponent.prototype.registerOnTouched = function (fn) {
        this._touchFun = fn;
    };
    GwPopSelectComponent.prototype._refreshUI = function () {
        var _this = this;
        if (this._data) {
            if (this._val) {
                this._data.forEach(function (item) {
                    if (item && item.id == _this._val) {
                        item.__checked__ = true;
                    }
                    else if (item && item.id != _this._val && item.__checked__) {
                        item.__checked__ = false;
                    }
                });
            }
            else {
                this._data.forEach(function (item) {
                    if (item && item.__checked__) {
                        item.__checked__ = false;
                    }
                });
            }
        }
    };
    return GwPopSelectComponent;
}());
export { GwPopSelectComponent };
GwPopSelectComponent.decorators = [
    { type: Component, args: [{
                selector: 'gw-popselect',
                encapsulation: ViewEncapsulation.None,
                styles: ["div.triangle { /*min-width: 50px;*/ /*min-height: 50px;*/ /*padding: 10px;*/ background: #fff; position: relative; border-radius: 5px; color: #000; border: 1px solid #aaa; } div.triangle-top:before { content: \"\"; position: absolute; top: 100%; left: 50%; margin-left: -7px; width: 0; height: 0; border: 7px solid transparent; border-top-color: #aaa; } div.triangle-top:after { content: \"\"; position: absolute; top: 100%; left: 50%; margin-top: -1px; margin-left: -7px; width: 0; height: 0; border: 7px solid transparent; border-top-color: #fff; } div.triangle-top-right:before { content: \"\"; position: absolute; top: 100%; left: 100%; margin-left: -24px; width: 0; height: 0; border: 7px solid transparent; border-top-color: #aaa; } div.triangle-top-right:after { content: \"\"; position: absolute; top: 100%; left: 100%; margin-top: -1px; margin-left: -24px; width: 0; height: 0; border: 7px solid transparent; border-top-color: #fff; } div.triangle-top-left:before { content: \"\"; position: absolute; top: 100%; left: 10px; width: 0; height: 0; border: 7px solid transparent; border-top-color: #aaa; } div.triangle-top-left:after { content: \"\"; position: absolute; top: 100%; left: 10px; width: 0; height: 0; margin-top: -1px; border: 7px solid transparent; border-top-color: #fff; } div.triangle-right:before { content: \"\"; position: absolute; top: 50%; left: 100%; width: 0; height: 0; margin-top: -7px; border: 7px solid transparent; border-left-color: #aaa; } div.triangle-right:after { content: \"\"; position: absolute; top: 50%; left: 100%; width: 0; height: 0; margin-top: -7px; margin-left: -1px; border: 7px solid transparent; border-left-color: #fff; } div.triangle-right-top:before { content: \"\"; position: absolute; top: 10px; left: 100%; width: 0; height: 0; border: 7px solid transparent; border-left-color: #aaa; } div.triangle-right-top:after { content: \"\"; position: absolute; top: 10px; left: 100%; width: 0; height: 0; margin-left: -1px; border: 7px solid transparent; border-left-color: #fff; } div.triangle-right-bottom:before { content: \"\"; position: absolute; top: 100%; left: 100%; width: 0; height: 0; margin-top: -24px; border: 7px solid transparent; border-left-color: #aaa; } div.triangle-right-bottom:after { content: \"\"; position: absolute; top: 100%; left: 100%; width: 0; height: 0; margin-left: -1px; margin-top: -24px; border: 7px solid transparent; border-left-color: #fff; } div.triangle-bottom:before { content: \"\"; position: absolute; top: 0; left: 50%; width: 0px; height: 0px; margin-left: -7px; margin-top: -14px; border: 7px solid transparent; border-bottom-color: #aaa; } div.triangle-bottom:after { content: \"\"; position: absolute; top: 0; left: 50%; width: 0px; height: 0px; margin-left: -7px; margin-top: -13px; border: 7px solid transparent; border-bottom-color: #fff; } div.triangle-bottom-left:before { content: \"\"; position: absolute; top: 0; left: 10px; width: 0px; height: 0px; margin-top: -14px; border: 7px solid transparent; border-bottom-color: #aaa; } div.triangle-bottom-left:after { content: \"\"; position: absolute; top: 0; left: 10px; width: 0px; height: 0px; margin-top: -13px; border: 7px solid transparent; border-bottom-color: #fff; } div.triangle-bottom-right:before { content: \"\"; position: absolute; top: 0; left: 100%; width: 0; height: 0; margin-left: -24px; margin-top: -14px; border: 7px solid transparent; border-bottom-color: #aaa; } div.triangle-bottom-right:after { content: \"\"; position: absolute; top: 0; left: 100%; width: 0; height: 0; margin-left: -24px; margin-top: -13px; border: 7px solid transparent; border-bottom-color: #fff; } div.triangle-left:before { content: \"\"; position: absolute; top: 50%; left: 0; width: 0; height: 0; margin-top: -7px; margin-left: -14px; border: 7px solid transparent; border-right-color: #aaa; } div.triangle-left:after { content: \"\"; position: absolute; top: 50%; left: 0; width: 0; height: 0; margin-top: -7px; margin-left: -13px; border: 7px solid transparent; border-right-color: #fff; } div.triangle-left-top:before { content: \"\"; position: absolute; top: 10px; left: 0; width: 0; height: 0; margin-left: -14px; border: 7px solid transparent; border-right-color: #aaa; } div.triangle-left-top:after { content: \"\"; position: absolute; top: 10px; left: 0; width: 0; height: 0; margin-left: -13px; border: 7px solid transparent; border-right-color: #fff; } div.triangle-left-bottom:before { content: \"\"; position: absolute; top: 100%; left: 0; width: 0; height: 0; margin-left: -14px; margin-top: -24px; border: 7px solid transparent; border-right-color: #ccc; } div.triangle-left-bottom:after { content: \"\"; position: absolute; top: 100%; left: 0; width: 0; height: 0; margin-left: -13px; margin-top: -24px; border: 7px solid transparent; border-right-color: #fff; }",
"/** * 全局css */ .hidden { display: none !important; } /** * overlay css */ .gw-overlay { position: absolute; z-index: 10; } /** * popconfirm css */ .gw-popconfirm { font-size: 12px; border-radius: 4px; min-width: 150px; box-shadow: 0 1px 6px rgba(0, 0, 0, .2); } .gw-popconfirm .gw-popconfirm-title { padding: 6px; border-bottom: 1px solid #aaa; } .gw-popconfirm .gw-popconfirm-footer { padding: 6px; text-align: right; } /** * popinput css */ .gw-popinput { font-size: 12px; border-radius: 4px; min-width: 150px; box-shadow: 0 1px 6px rgba(0, 0, 0, .2); } .gw-popinput .gw-popinput-title, .gw-popinput .gw-popinput-body { padding: 6px; border-bottom: 1px solid #aaa; } .gw-popinput .gw-popinput-body input { width: 100%; } .gw-popinput .gw-popinput-footer { padding: 6px; text-align: right; } /** * confirm css */ .gw-confirm-mask { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: #aaaaaa; opacity: 0.3; z-index: 10000; } .gw-confirm { position: fixed; top: 50%; left: 50%; opacity: 1; transform: translate(-50%, -50%); z-index: 10001; background-color: #ffffff; border-radius: 4px; min-width: 200px; padding: 6px; } .gw-confirm .gw-confirm-title { font-weight: bold; } .gw-confirm .gw-confirm-footer { text-align: right; } /** * popselect css */ .gw-popselect { font-size: 12px; } .gw-popselect .gw-popselect-filter { margin: 10px; } .gw-popselect .gw-popselect-filter input { border: 1px solid #cccccc; width: 100%; padding-left: 5px; padding-top: 3px; } .gw-popselect .gw-popselect-body { border-bottom: 1px solid #aaa; padding: 0 0 10px 0; } .gw-popselect .gw-popselect-body ul { list-style: none; padding: 0; margin: 0; max-height: 220px; overflow: auto; } .gw-popselect .gw-popselect-body ul li { padding: 0 10px; } .gw-popselect .gw-popselect-body ul li:hover { background-color: antiquewhite; } .gw-popselect .gw-popselect-body label { width: 100%; font-weight: normal; margin: 2px 0; } .gw-popselect .gw-popselect-body input { height: 11px; } .gw-popselect .gw-popselect-footer { text-align: right; margin: 5px 10px; }"],
                template: "\n        <div gw-overlay\n             [source]=\"source\"\n             [placement]=\"placement\"\n             (onHide)=\"onOverlayHideEvent()\"\n             [zIndex]=\"zIndex\">\n            <div class=\"triangle triangle-{{placement}}\">\n                <div class=\"gw-popselect\">\n                    <div class=\"gw-popselect-filter\" *ngIf=\"showFilter\">\n                        <input type=\"text\" placeholder=\"\u8FC7\u6EE4...\" [(ngModel)]=\"_filterVal\">\n                    </div>\n                    <div class=\"gw-popselect-body\">\n                        <ul>\n                            <li *ngFor=\"let item of (data | multiKeysFilter:_filterVal:filterKeys)\">\n                                <label>\n                                    <input type=\"checkbox\" [(ngModel)]=\"item.__checked__\" name=\"checkbox\"\n                                           (change)=\"onSelect(item)\">\n                                    <span>{{item.text}}</span>\n                                </label>\n                            </li>\n                        </ul>\n                    </div>\n                    <div class=\"gw-popselect-footer\">\n                        <button class=\"btn btn-xs btn-primary\" (click)=\"onConfirmEvent($event)\">\u786E\u8BA4</button>\n                        <button class=\"btn btn-xs btn-default\" (click)=\"onCancelEvent($event)\">\u53D6\u6D88</button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    ",
                providers: [GW_POPSELECT_COMPONENT_VALUE_ACCESSOR]
            },] },
];
GwPopSelectComponent.ctorParameters = function () { return []; };
GwPopSelectComponent.propDecorators = {
    'filterKeys': [{ type: Input },],
    'showFilter': [{ type: Input },],
    'placement': [{ type: Input },],
    'source': [{ type: Input },],
    'zIndex': [{ type: Input },],
    'onConfirm': [{ type: Output },],
    'onCancel': [{ type: Output },],
    'overlay': [{ type: ViewChild, args: [GwOverlayDirective,] },],
    'data': [{ type: Input },],
};
//# sourceMappingURL=popselect.component.js.map